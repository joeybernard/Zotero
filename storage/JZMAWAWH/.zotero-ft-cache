Computers & Fluids 117 (2015) 168â€“182
Contents lists available at ScienceDirect
Computers & Fluids
journal homepage: www.elsevier.com/locate/compï¬‚uid

Semi-implicit BDF time discretization of the Navierâ€“Stokes equations with VMS-LES modeling in a High Performance Computing framework
Davide Forti, Luca DedÃ¨ â‡‘
CMCS â€“ Chair of Modeling and Scientiï¬c Computing, MATHICSE â€“ Mathematics Institute of Computational Science and Engineering, EPFL â€“ Ã‰cole Polytechnique FÃ©dÃ©rale de Lausanne, Station 8, Lausanne CH-1015, Switzerland

article info
Article history: Received 3 April 2015 Received in revised form 13 May 2015 Accepted 14 May 2015 Available online 23 May 2015
Keywords: Navierâ€“Stokes equations Variational Multiscale modeling Backward Differentiation Formulas Finite Element method Large Eddy Simulation High Performance Computing

abstract
In this paper, we propose a semi-implicit approach for the time discretization of the Navierâ€“Stokes equations with Variational Multiscale-Large Eddy Simulation turbulence modeling (VMS-LES). For the spatial approximation of the problem, we use the Finite Element method, while we employ the Backward Differentiation Formulas (BDF) for the time discretization. We treat the nonlinear terms arising in the variational formulation of the problem with a semi-implicit approach leading to a linear system associated to the fully discrete problem which needs to be assembled and solved only once at each discrete time instance. We solve this linear system by means of the GMRES method by employing a multigrid (ML) right preconditioner for the parallel setting. We validate the proposed fully discrete scheme towards the benchmark problem of the ï¬‚ow past a squared cylinder at high Reynolds number and we show the computational efï¬ciency and scalability results of the solver in a High Performance Computing framework.
Ã“ 2015 Elsevier Ltd. All rights reserved.

1. Introduction
In this work, we consider the Navierâ€“Stokes equations with Variational Multiscale-Large Eddy Simulation (VMS-LES) modeling of turbulence for incompressible Newtonian ï¬‚uids at high Reynolds number, with the focus being on their efï¬cient time discretization and, more in general, their numerical solution in a parallel setting. Indeed, the accurate and efï¬cient simulation of turbulent ï¬‚ows still represents a major challenge, even in a High Performance Computing framework. The Direct Numerical Simulation (DNS) of turbulent ï¬‚ows requires the full representation of the whole range of spatial and temporal turbulent scales at the discrete level [24,38,40]; as consequence, even for moderate Reynolds numbers, the DNS may be unfeasible for several problems of practical interest. Conversely, with Large Eddy Simulation (LES) approaches [39,40,47] only the â€˜â€˜largeâ€™â€™ scales of the ï¬‚ow ï¬eld are fully represented and resolved at the discrete level, while the effect of the â€˜â€˜smallâ€™â€™ unresolved scales is taken into account by means of suitable models based on the resolved scales, thus making the computational costs more affordable; among the others, examples of established LES models are the Smagorinsky [49] and dynamic Smagorinsky [18,35] models.
â‡‘ Corresponding author. Tel.: +41 21 6932909; fax: +41 21 6935510.
E-mail address: luca.dede@epï¬‚.ch (L. DedÃ¨).
http://dx.doi.org/10.1016/j.compï¬‚uid.2015.05.011 0045-7930/Ã“ 2015 Elsevier Ltd. All rights reserved.

The concept of deï¬ning LES models for the Navierâ€“Stokes equations by means of the Variational Multiscale method (VMS) ([29,34]) has been introduced in [31] and further extended in [32,33]; since then, the so called VMS-LES method has been widely developed and used for the numerical simulation of turbulent ï¬‚ows in several benchmarking and applicative contexts [1â€“4,8,13, 20,25,28,30]. Indeed, the VMS-LES method is advantageous since it provides a uniï¬ed framework for the deï¬nition of spatial approximation schemes which are stable in the sense of the well-posedness, capable of controlling the numerical instabilities arising in the convective regimes at high Reynolds numbers, and adequate to represent the turbulence LES modeling. In this framework, the LES model or ï¬lter stems from a low order approximation of the nonlinear terms deriving from the residual based VMS formulation applied to the incompressible Navierâ€“Stokes equations.
In this work, we focus on efï¬cient spatial and, above all, time discretization schemes for the incompressible Navierâ€“Stokes equations with VMS-LES modeling of turbulence by aiming at the simulation of ï¬‚ows at high Reynolds number in a parallel framework. In particular, the problem is ï¬rst discretized in space by using the Finite Element method [43], mainly with basis functions of low polynomial degree, and then in time by means of Finite Differences [41]. More speciï¬cally, we approximate the time derivative in the Navierâ€“Stokes equations by means of Backward

D. Forti, L. DedÃ¨ / Computers & Fluids 117 (2015) 168â€“182

169

Differentiation Formulas (BDF) of orders 1; 2, or higher; see e.g. [19,41]. Then, in order to obtain an efï¬cient formulation, we propose a semi-implicit treatment of the nonlinear terms appearing in the fully discrete scheme, for which we â€˜â€˜linearizeâ€™â€™ the discrete problem at each discrete time instance by means of temporal extrapolations based on Newtonâ€“Gregory backward polynomials [44]. The approach proposed leads to assemble and solve a unique linear system for each discrete time instance; conversely, a fully implicit approach, e.g. using the Newton method, would require, in principle, repeated assembly and solutions of a linear system. While our semi-implicit BDF method for VMS-LES modeling may require restrictions on the time step due to stability issues of the time discretization scheme, these can be offset by the larger computational costs associated instead to a fully implicit approach; in practice, our numerical experience indicates that stable solutions for the semi-implicit BDF scheme are obtained also for relatively â€˜â€˜largeâ€™â€™ time steps, conversely to explicit schemes for which limitations on their size are generally more severe. We remark that, in literature, VMS-LES formulations of the Navierâ€“Stokes equations are often discretized in time by means
of implicit schemes [2,20,28] as the generalized-a method ([21]),
low order semi-implicit schemes as the backward Euler method with Picard â€˜â€˜linearizationâ€™â€™ [13], or explicit schemes as done in [25] with a Rungeâ€“Kutta scheme. In this respect, we remark that the main contribution of this work consists in deï¬ning a semi-implicit BDF scheme for the approximation of the Navierâ€“ Stokes equations with turbulence VMS-LES modeling, which allows efï¬cient and accurate numerical solutions of the problem, without incurring in severe restrictions of the time step.
Since we aim at solving large scale problems at high Reynolds number, the use of parallel architectures is necessary [22]. In such parallel framework, in addition to suitable choices of the spatial and time discretization schemes, we stress the fact that the use of an efï¬cient linear solver is often mandatory to make the numerical simulations computationally feasible. Nevertheless, the efï¬cacy of the linear solver and preconditioning strategies for VMS-LES formulations are relatively little explored in literature; in [13] a balancing Neumannâ€“Neumann domain decomposition method is used for preconditioning with the GMRES iterative solver, while in [20] algebraic multigrid ([46]) strategies for VMS-LES modeling are discussed. In this work, we combine our semi-implicit BDF time discretization scheme for the Navierâ€“Stokes equations with VMS-LES modeling together with a parallel multigrid right preconditioner based on the package ML of Trilinos [17] applied to the GMRES linear iterative solver. In this manner, we obtain an efï¬cient solver for the High Performance Computing implemented in the open-source Finite Element library LifeV [55].
The proposed numerical scheme is tested for the vortex shedding benchmark problem of an incompressible ï¬‚uid ï¬‚ow at high Reynolds number (Re Â¼ 22; 000) past a squared cylinder; this benchmark allows us to validate our numerical strategy against the results obtained with other LES models [25,45,50] and also by means of experimental tests [5,36]. In our study, we present and discuss the numerical results obtained by considering both ï¬rst and second degree Lagrange polynomials for the Finite Element representation of the ï¬‚uid velocity and pressure ï¬elds, ï¬rst and second order semi-implicit BDF scheme, and different time steps. Furthermore, we analyze the energy spectra obtained for the spatial discretizations under consideration. Then, regarding the efï¬ciency of the linear parallel solver, we investigate its strong scalability properties by solving the benchmark problem at hand on supercomputer machines. Finally, we discuss the choice of the stabilization parameters appearing in the VMS-LES formulation and their role in obtaining numerical simulations which feature affordable computational costs. In particular, we consider in this work stabilization parameters which involve the time step in the

quasi-static approximation of the ï¬ne scale differential operator, similarly to [2]. In this respect, we compare, for the vortex shedding benchmark problem, the spatial distribution of stabilization parameters, chosen both as dependent and independent of the time step, and we highlight their impact on the efï¬ciency of the GMRES solver with multigrid preconditioner.
The paper is organized as follows. In Section 2, after recalling the Navierâ€“Stokes equations with VMS-LES modeling of turbulence, we introduce the spatial discretization of the coarse scale velocity and pressure ï¬elds by means of the Finite Element method. In Section 3, we focus on the semi-implicit time discretization of the problem by means of BDF formulas. Then, in Section 4, we describe the parallel solver developed for the fully discrete problem, as well as the multigrid preconditioner used. In Section 5, we report and discuss the numerical results on the squared cylinder benchmark problem and we analyze the choice of the stabilization parameters associated to the VMS-LES formulation. Conclusions follow in Section 6.

2. Variational Multiscale LES modeling for the Navierâ€“Stokes equations

In this section we start by recalling the strong formulation of the incompressible Navierâ€“Stokes, the VMS-LES modeling and the spatial approximation based on the Finite Element method.

2.1. The incompressible Navierâ€“Stokes equations

Let X & Rd be the spatial ï¬‚uid domain with piecewise smooth boundary C  @X, for which we consider the dimension d Â¼ 3; we denote with CD the subset of C where the essential (Dirichlet) boundary conditions are applied, while natural (Neumann) boundary conditions will be considered on CN Â¼ C n CD. The Navierâ€“Stokes equations for an incompressible ï¬‚uid read:

q

@u @t

Ã¾

qu

Ã

ru

Ã€

r

Ã

rÃ°u;

pÃ

Â¼

f

in X Ã‚ Ã°0; TÃ;

Ã°1Ã

r Ã u Â¼ 0 in X Ã‚ Ã°0; TÃ;

Ã°2Ã

u Â¼ g on CD Ã‚ Ã°0; TÃ;

Ã°3Ã

rÃ°u; pÃn^ Â¼ h on CN Ã‚ Ã°0; TÃ;

Ã°4Ã

uÃ°0Ã Â¼ u0 in X Ã‚ f0g;

Ã°5Ã

where the dependent variables u and p indicate the velocity and the
pressure of the ï¬‚uid, respectively, q is the density, f is the vector of external forces, n^ is the outward directed unit normal vector to CN, and r is the stress tensor deï¬ned, for a Newtonian ï¬‚uid, as:

rÃ°u; pÃ Â¼ Ã€pI Ã¾ 2lÃ°uÃ;

Ã°6Ã

we denoted by l the dynamic viscosity of the ï¬‚uid and by I the

second order identity tensor, while Ã°uÃ is the strain tensor:

Ã°uÃ

Â¼

1 2

 ru

Ã¾

Ã°ruÃT

 :

Ã°7Ã

The functions g and h indicate the Dirichlet and Neumann data,

respectively, while u0 the initial data. We recall that Eqs. (1)â€“(5) represent the balance of momentum in convective form, the mass

conservation, the essential and natural boundary conditions, and

the initial condition on the velocity, respectively.

In view of the spatial approximation of the Navierâ€“Stokes equa-

tions, we introduce the inï¬nite dimensional function spaces

Vg

:Â¼

fu

2

h H1

id Ã°XÃ

:

ujCD

Â¼

gg; V 0

:Â¼

fu

2

h H1

id Ã°XÃ

:

ujCD Â¼ 0g,

and Q :Â¼ L2Ã°XÃ; in addition, we deï¬ne the function spaces

Vg :Â¼ V g Ã‚ Q and V0 :Â¼ V 0 Ã‚ Q. Then, the weak formulation of

the Navierâ€“Stokes equations reads, for all t 2 Ã°0; TÃ ([43]):

170

D. Forti, L. DedÃ¨ / Computers & Fluids 117 (2015) 168â€“182

Î“in

Lin

y

D

Lout

Î“out 2H

z

x Ls

Fig. 1. Computational domain X considered for the squared cylinder benchmark problem.

Fig. 2. Computational mesh used for the numerical simulation of the ï¬‚ow past a squared cylinder.

Table 1 Number of degrees of freedom used in our simulations for the mesh of Fig. 2.

FE discretization

Number of dofs

P1â€“P1 P2â€“P2

1,323,056 9,209,040

find

U

Â¼ UÃ°tÃ 

Â¼

fu; 

pg

2

Vg

:

w;

q

@u @t

Ã¾ Ã°w; qu

Ã

ruÃ

Ã¾

 rw;


l ru

Ã¾

 Ã°ruÃT

Ã€ Ã°r Ã w; pÃ Ã¾ Ã°q; r Ã uÃ

Â¼ Ã°w; f Ã Ã¾ Ã°w; hÃCN for all W Â¼ fw; qg 2 V0;

Ã°8Ã

where uÃ°0Ã Â¼ u0; Ã°Ã; ÃÃ denotes the standard L2 inner product with respect to the spatial domain X and Ã°Ã; ÃÃCN the one on CN.

2.2. Spatial approximation: Finite Element method and VMS-LES modeling

We consider the Variational Multiscale (VMS) [2,34] method applied to the standard weak form of the Navierâ€“Stokes equations (8). The VMS method introduces a priori a decomposition of the solution into coarse and ï¬ne scales. Accordingly, the weak formulation of the Navierâ€“Stokes equations (8) is split into coarse and ï¬ne scale subproblems. The coarse scale solution is identiï¬ed with the numerical approximation given by the Finite Element method, while the ï¬ne scale component needs to be modeled. We remark

that the ï¬ne scale component of the solution is often modeled

analytically (in closed form), written in terms depending both on

the data of the problem and the coarse scale solution, and ï¬nally

substituted in the coarse scale subproblem. In virtue of a projection

of the ï¬ne scale solution into the coarse one, a ï¬nite dimensional

system for the coarse scale component of the solution is obtained.

Let us introduce at this point a suitable Finite Element dis-

cretization, speciï¬cally with piecewise Lagrange polynomials of

degree r P 1 over the computational domain X that is triangulated

with a mesh T h comnprised of tetrahedrons; in this respeoct, we

indicate

with

X

h r

:Â¼

vh 2 C0Ã°XÃ : vhjK 2 Pr; for all K 2 T h

the

function space of Finite Element and with hK the diameter of the mesh element K 2 T h.
We consider a multiscale direct-sum decomposition of a

general function space V, which can be interpreted either as Vg or V0, into the coarse and ï¬ne scales subspaces as:

V Â¼ Vh Ãˆ V0;

Ã°9Ã

where Vh is the coarse scale function space associated to the Finite Element discretization and V0 is an inï¬nite dimensional function

space representing the ï¬ne scales not directly represented in the

discretization;

Vh

Â¼

V

h 0

Ã‚

Qh,

more with

speciï¬cally,

V

h g

:Â¼

V

g

\

we have

h X

h r

id

;

V

h 0

:Â¼

Vh V0

Â¼V h
\X

hrhgiÃ‚d ,

Qh

or and

Qh :Â¼ Q \ Xhr . We remark that we use the same Finite Element space

X

h r

of

degree

r

to

deï¬ne

the

spatial

discretization

for

both

the

veloc-

ity and pressure variables. Then, we have from Eq. (9) the following

decompositions:

D. Forti, L. DedÃ¨ / Computers & Fluids 117 (2015) 168â€“182

171

Fig. 3. Post-processing of the results at time t Â¼ 10 s. Solution obtained using P2â€“P2 Finite Element, BDF2, and Dt Â¼ 0:0025 s.

w Â¼ wh Ã¾ w0; q Â¼ qh Ã¾ q0; u Â¼ uh Ã¾ u0; p Â¼ ph Ã¾ p0:

Ã°10Ã Ã°11Ã Ã°12Ã Ã°13Ã

Without entering into the details of the derivation, we follow the approach proposed in [2], for which we decompose Eq. (8) into coarse and ï¬ne scale equations, we integrate by parts the ï¬ne scale terms appearing into the coarse scale equations, and ï¬nally we model the ï¬ne scale velocity and pressure variables as ([2]):

u0 â€™ Ã€sMÃ°uhÃrMÃ°uh; phÃ; p0 â€™ Ã€sCÃ°uhÃrCÃ°uhÃ;

Ã°14Ã Ã°15Ã

where rMÃ°uh; phÃ and rCÃ°uhÃ indicate the strong residuals of the momentum and continuity equations:

rM Ã°uh ;

ph Ã

Â¼

q

@uh @t

Ã¾

quh

Ã

ruh

Ã¾

rph

Ã€

lDuh

Ã€

f

;

rC Ã°uhÃ Â¼ r Ã uh;

Ã°16Ã Ã°17Ã

respectively. Moreover, sM and sC are the stabilization parameters,

which we choose similarly to [2] as:

sM Â¼ sMÃ°uhÃ Â¼

r2q2
Dt2

Ã¾

q2
h2K

juh j2

Ã¾

l2
h4K

!Ã€1=2

Cr

;

Ã°18Ã

sC

Â¼

sC Ã°uh Ã

Â¼

h2K
sM Ã°uh Ã

;

Ã°19Ã

where Cr Â¼ 60 Ã 2rÃ€2 is a constant obtained by an inverse inequality
relation, r is a constant equal to the order of the time discretization
chosen and Dt is the time step that will be chosen for the time discretization. We remark that the expression chosen for the stabilization
parameter sM does not account for the projection of the advective
and diffusive terms onto the characteristic sizes of the mesh element along the Cartesian components as e.g. in [2,28,48,51], but rather it is â€˜â€˜averagedâ€™â€™ for simplicity over the mesh element.
Finally, the semi-discrete variational multiscale formulation (VMS-LES) of the Navierâ€“Stokes equations written in terms of the weak residual reads, for all t 2 Ã°0; TÃ:

find

Uh

Â¼

UhÃ°tÃ

Â¼

fuh; phg

2

V

h g

:

AÃ°Wh; UhÃ

Ã€

F Ã°W h Ã

Â¼

0

for all Wh Â¼ fwh; qhg 2 Vh0;

Ã°20Ã

with uhÃ°0Ã Â¼ u0, where: AÃ°Wh; UhÃ :Â¼ ANSÃ°Wh; UhÃ Ã¾ AVMSÃ°Wh; UhÃ;

Ã°21Ã

FÃ°WhÃ :Â¼ Ã°wh; f Ã Ã¾ Ã°wh; hÃCN ;

with:

ANSÃ°W h;

UhÃ

:Â¼

 wh;

q

@uh @t

Ã¾

Ã€wh;

quh

Ã

ruhÃ

Ã¾

 rwh;


l ruh

Ã¾

 Ã°ruhÃT

Ã€

Ã€ r

Ã

wh ;

ph Ã

Ã¾

Ã€qh

;

r

Ã

uh

Ã ;

Ã°22Ã Ã°23Ã

172

D. Forti, L. DedÃ¨ / Computers & Fluids 117 (2015) 168â€“182

3 2
2.8
1 2.6
0 2.4

2.2

âˆ’1

2

âˆ’2

2

4

6

8

10

2

4

6

8

10

3 2
2.8
1 2.6
0 2.4

2.2

âˆ’1

2

âˆ’2

2

4

6

8

10

2

4

6

8

10

3
2 2.8
1 2.6

0 2.4

2.2

âˆ’1

2

âˆ’2

2

4

6

8

10

2

4

6

8

10

Fig. 4. Results obtained by P1â€“P1 Finite Element and the BDF1 scheme; CD (left) and CL (right) vs. time t [s] for Dt Â¼ 0:005 s (top), 0.0025 s (mid), and 0.00125 s (bottom).

AVMS Ã°W h ;

UhÃ

:Â¼ Ã€quh
Ã€ Ã€r


ÃÃwrhw; shCÃ¾Ã°urhÃqrhC;Ã°suMhÃÃ°Ãuh

ÃrM

Ã°uh;

ph

Ã Ã



Ã¾ quh Ã Ã°ruhÃT ; sMÃ°uhÃrMÃ°uh; phÃ

Ã€ Ã€rwh; sMÃ°uhÃrMÃ°uh; phÃ  sMÃ°uhÃrMÃ°uh; phÃÃ:

Ã°24Ã

We remark that Eq. (23) deï¬nes the standard terms of the Navierâ€“ Stokes equations in weak formulation, while Eq. (24) contains the terms obtained from the application of the VMS-LES method. In this respect, the ï¬rst row of Eq. (24) represents the classical Streamline-Upwind Petrovâ€“Galerkin (SUPG) stabilization terms, while the second and third rows contain terms peculiar of the VMS stabilization; speciï¬cally, the second row indicates an additional stabilization term complementing the SUPG ones and ï¬nally the third row models the Reynolds cross-stress, which realizes the LES modeling of turbulence [2].

3. Time discretization: semi-implicit BDF schemes
We consider the time discretization of problem (20) by means of the Backward Differentiation Formulas (BDF) [7,16,41], a family of linear multistep methods for which the ï¬rst order derivative is replaced by a one-sided, high order incremental ratio; such BDF schemes are often used in computational ï¬‚uid dynamics, as for example in [19].

3.1. Fully implicit BDF schemes

Let us partition the time interval Â½0; TÂŠ into Nt subintervals of

equal

size

Dt

Â¼

T Nt

for

which

the

discrete

time

instances

are

tn Â¼ nDt for n Â¼ 0; . . . ; Nt. Furthermore, let us denote with uhn and

phn the approximations of the velocity uh and pressure ph ï¬elds at

the time tn. According to the order r of the BDF scheme, the

D. Forti, L. DedÃ¨ / Computers & Fluids 117 (2015) 168â€“182

173

approximation of the time derivative of the velocity appearing in the Navierâ€“Stokes equations reads:

@uh @t

%

aruhnÃ¾1 Ã€ uhn;BDFr
Dt

;

Ã°25Ã

where for BDF schemes of orders r Â¼ 1; 2; 3 we have:

8 >< uhn

uhn;BDFr

Â¼

>:

2uhn 3uhn

Ã€ Ã€

1 2

uhnÃ€1

3 2

uhnÃ€1

Ã¾

1 3

uhnÃ€2

if n P 0; if n P 1; if n P 2;

forr Â¼ 1 Ã°BDF1Ã; forr Â¼ 2 Ã°BDF2Ã; forr Â¼ 3 Ã°BDF3Ã;
Ã°26Ã

and

8 >< 1;

for r Â¼ 1 Ã°BDF1Ã;

ar

Â¼

>:

3 2

;

11 6

;

for r Â¼ 2 Ã°BDF2Ã; for r Â¼ 3 Ã°BDF3Ã:

Ã°27Ã

According to the approximation of the time derivative, Eq. (25) is replaced in Eq. (20), while the other time dependent terms are evaluated at the general discrete time instance tnÃ¾1. In this way, after the spatial and time discretizations, the fully discrete formulation of problem (20) reads at time tnÃ¾1 and for a given BDF scheme of
order r:

find

uhnÃ¾1

2

V

h g

and

phnÃ¾1

2

Qh

!

:

wh; q aruhnÃ¾1 Ã€ uhn;BDFr
Dt

Ã¾ Ã€wh; quhnÃ¾1 Ã ruhnÃ¾1Ã

Ã¾

 rwh;


l ruhnÃ¾1

Ã¾

 Ã°ruhnÃ¾1 ÃT

Ã€

Ã€ r

Ã

wh;

phnÃ¾1 Ã

Ã¾ Ã¾ Ã€

Ã€Ã€Ã€qrqhu;ÃhnrwÃ¾1hÃÃ;urshnCÃ¾wÃ°1uÃhhnÃ¾Ã¾1

ÃrrCqÃ°hu; shnÃ¾M1Ã°ÃuÃhnÃ¾1ÃrM

Ã°uhnÃ¾1

;

phnÃ¾1 

Ã Ã

Ã¾ quhnÃ¾1 Ã Ã°rwhÃT ; sMÃ°uhnÃ¾1ÃrMÃ°uhnÃ¾1; phnÃ¾1Ã

Â¼Ã€Ã€wÃ€rh;wf nhÃ¾; 1sÃMÃ¾Ã°uÃ€hnwÃ¾1hÃ;rhMnÃ°Ã¾u1hnÃÃ¾C1N;;pfhnoÃ¾r1

Ã all

sM
wh

Ã°uhnÃ¾1 ÃrM Ã°uhnÃ¾1

2

V

h 0

and

qh

;

phnÃ¾1

Ã Ã

2 Qh; for all n P r Ã€ 1;

Ã°28Ã

given uhn;. . . ; uhnÃ¾1Ã€r, with f nÃ¾1 Â¼ f Ã°tnÃ¾1Ã, hnÃ¾1 Â¼ hÃ°tnÃ¾1Ã rMÃ°uhnÃ¾1;

q q l phnÃ¾1Ã :Â¼

ar uhnÃ¾1 Ã€uhn;BDFr Dt

Ã¾

uhnÃ¾1 Ã ruhnÃ¾1 Ã¾ rphnÃ¾1 Ã€

DuhnÃ¾1 Ã€ f nÃ¾1:

We notice that the BDF1 scheme coincides with the Backward Euler method. In this work, we consider a ï¬xed time step Dt; nevertheless, it is possible to use a time varying or adaptive time step compatible with the BDF schemes, as done e.g. in [9,53].
At each discrete time tn, the BDF scheme yields a nonlinear problem to be solved, since (28) is nonlinear in the variables uhnÃ¾1 and phnÃ¾1. An approximation of this nonlinear problem can be obtained for example with the Newton method [41]. This requires, at each Newton iterate, the assembly of the Jacobian matrix and the solution of a linear system. A fully implicit approach, although obtained for different time discretizations, has been widely used for the study of incompressible ï¬‚uid ï¬‚ows in turbulent regimes as e.g. in [2,25,37]. However, while a fully implicit approach is generally yielding a stable time discretization scheme, the associated computational costs may be signiï¬cantly high due to the repeated assembly of the residual vector and Jacobian matrix and the solution of the associated linear system.

3.2. Semi-implicit BDF schemes

In this paper, in order to contain the computational burden

associated to the use of a fully implicit BDF approach (28), we con-

sider instead a semi-implicit BDF scheme derived from problem

(28), for which the nonlinear terms in uhnÃ¾1 and phnÃ¾1 are extrapolated by means of the Newtonâ€“Gregory backward polynomials

[10,44]. Without entering into the details of the derivation, for

which we refer the reader to e.g. [10,44], we consider the following

extrapolations of orders r Â¼ 1; 2; 3 for the velocity and pressure

variables at the discrete time tnÃ¾1:

8 >>>< uhn

if n P 0;

uhnÃ¾1;r

Â¼

>>>:

2uhn 3uhn

Ã€ Ã€

uhnÃ€1 3uhnÃ€1

Ã¾ uhnÃ€2

if n P 1; if n P 2;

for r Â¼ 1 Ã°BDF1Ã; for r Â¼ 2 Ã°BDF2Ã; for r Â¼ 3 Ã°BDF3Ã;

Ã°29Ã

and similarly:

8 >>>< phn

phnÃ¾1;r

Â¼

>>>:

2phn 3phn

Ã€ Ã€

phnÃ€1 3phnÃ€1

Ã¾

phnÃ€2

if n P 0; if n P 1; if n P 2;

for r Â¼ 1 Ã°BDF1Ã; for r Â¼ 2 Ã°BDF2Ã; for r Â¼ 3 Ã°BDF3Ã:
Ã°30Ã

Starting from the fully implicit formulation (28), we use the above extrapolations by Newtonâ€“Gregory backward polynomials. In this
way, for a given BDF scheme of order r, the fully discrete linearized
semi-implicit formulation of problem (28) reads:

find

uhnÃ¾1

2 :

V

h g

andphnÃ¾1

2

Qh

!

wh

;

q

ar

uhnÃ¾1 Ã€ Dt

uhn;BDFr

Ã¾


wh; quhnÃ¾1;r

Ã

 ruhnÃ¾1

Ã¾

 rwh;


l ruhnÃ¾1

Ã¾



Ã°ruhnÃ¾1

T
Ã

Ã€

Ã€ r

Ã

wh;

phnÃ¾1 Ã

Ã¾

Ã€qh 

;

r

Ã

uhnÃ¾1

Ã



s q Ã¾

uhnÃ¾1;r Ã rwh Ã¾ rqh;

nÃ¾1;r
M

rnMÃ¾1;r

Ã°uhnÃ¾1;

phnÃ¾1

Ã





Ã€

s r Ã wh;

nÃ¾1;r
C

r

C

Ã°uhnÃ¾1

Ã





q s Ã¾

uhnÃ¾1;r Ã Ã°rwhÃT ;

nÃ¾1;r
M

rnMÃ¾1;r Ã°uhnÃ¾1

;

phnÃ¾1

Ã





s s Ã€

rwh;

nÃ¾1;r
M

br nMÃ¾1;r



nÃ¾1;r
M

er nMÃ¾1;rÃ°uhnÃ¾1; phnÃ¾1Ã

Ã€

 rwh;

snÃ¾1;r M

br nMÃ¾1;r



snÃ¾1;r M

qar

uhnÃ¾1  Dt

!

s s q Ã¾

rwh;

nÃ¾1;r
M

rnMÃ¾1;r

Ã°uhnÃ¾1

;

phnÃ¾1

Ã



nÃ¾1;r
M

uhn;BDFr Dt

Â¼

Ã€wh;

f

Ã
nÃ¾1

Ã¾

Ã€wh;

Ã hnÃ¾1 CN

;

for all wh

2

V

h 0

and

qh 2 Qh;

for all n P r Ã€ 1;

Ã°31Ã

given uhn; . . . ; uhnÃ¾1Ã€r, where the stabilization parameters are deï¬ned as follows:

snÃ¾1;r M

:Â¼

r2q2
Dt2

Ã¾

q2
h2K

uhnÃ¾1;r2

Ã¾

l2
h4K

!Ã€1=2

Cr

;

Ã°32Ã

nÃ¾1;r
s s C

Â¼

h2K
nÃ¾1;r

;

M

Ã°33Ã

and the residuals read:

174

D. Forti, L. DedÃ¨ / Computers & Fluids 117 (2015) 168â€“182

3 2
2.8
1 2.6
0 2.4

2.2

âˆ’1

2

âˆ’2

2

4

6

8

10

2

4

6

8

10

3 2
2.8
1 2.6
0 2.4

2.2

âˆ’1

2

âˆ’2

2

4

6

8

10

2

4

6

8

10

3
2 2.8
1 2.6

0 2.4

2.2

âˆ’1

2

âˆ’2

2

4

6

8

10

2

4

6

8

10

Fig. 5. Results obtained by P1â€“P1 Finite Element and the BDF2 scheme; CD (left) and CL (right) vs. time t [s] for Dt Â¼ 0:005 s (top), 0.0025 s (mid), and 0.00125 s (bottom).

rnMÃ¾1;rÃ°uhnÃ¾1; phnÃ¾1Ã :Â¼ q

!
aruhnÃ¾1 Ã€ uhn;BDFr
Dt

l Ã¾ quhnÃ¾1;r Ã ruhnÃ¾1 Ã¾ rphnÃ¾1 Ã€ DuhnÃ¾1 Ã€ f nÃ¾1;
br nMÃ¾1;r :Â¼ rnMÃ¾1;rÃ°uhnÃ¾1;r; phnÃ¾1;rÃ;
l er nMÃ¾1;rÃ°uhnÃ¾1; phnÃ¾1Ã :Â¼ quhnÃ¾1;r Ã ruhnÃ¾1 Ã¾ rphnÃ¾1 Ã€ DuhnÃ¾1 Ã€ f nÃ¾1:
Ã°34Ã

Thanks to the time discretization proposed, the fully discrete semi-implicit formulation (31) yields a linear problem in the variables uhnÃ¾1 and phnÃ¾1 to be solved only once at each time tn. We remark that the Newtonâ€“Gregory extrapolation of the pressure variable in Eq. (30) is required by the terms of the formulation which carry the LES modeling. In this respect, we notice that a

linearization of Eq. (28) by means of ï¬rst order FrechÃ©t differentiation would have led to a semi-implicit formulation with a larger number of terms than in Eq. (31), thus resulting in a larger assembly cost than in the proposed semi-implicit BDF formulation.
Finally, we remark that semi-implicit BDF methods with Newtonâ€“Gregory extrapolation yield stable time discretization schemes if the velocity ï¬eld is divergence free a.e. in the computational domain. However, this requirement is not guaranteed for the spatially approximated velocity ï¬eld uhn obtained by solving the Navierâ€“Stokes equations in the VMS-LES formulation, which in principle would require restrictions on the choice of the time step. Nevertheless, our numerical experience indicates that the use of relatively â€˜â€˜largeâ€™â€™ time steps still yields stable solutions for the proposed semi-implicit VMS-LES method with BDF time discretization.

D. Forti, L. DedÃ¨ / Computers & Fluids 117 (2015) 168â€“182

175

4. Linear parallel solver: GMRES with multigrid preconditioner
We implement the semi-implicit VMS-LES method with BDF time discretization in the open-source Finite Element library LifeV [55] for the High Performance Computing of problems described by PDEs. In our numerical tests, the linear system arising from Eq. (31) is solved in a parallel setting using the GMRES method preconditioned by an algebraic three levels multigrid preconditioner based on the ML package of Trilinos [17]; see e.g. [42,52]. For the application of the multigrid (ML) right preconditioner to the matrix we perform three sweeps of the Gaussâ€“Seidel algorithm for pre- and post-smoothing, while the solution on the coarsest level is based on a LU factorization [41]. In our computations, we consider the relative residual as stopping criterion for the GMRES method with tolerance equal to 10Ã€6.

5. Numerical results
In this section we validate the semi-implicit BDF VMS-LES scheme towards the benchmark problem of the vortex shedding induced by the ï¬‚uid ï¬‚ow past a squared cylinder at high Reynolds number [25]. The simulations have been carried out for different orders of both the time and spatial discretizations and for different time steps with the aim of studying their inï¬‚uence on the accuracy of the numerical solution. We discuss the numerical performance of the solver and analyze the inï¬‚uence of the stabilization parameters on the numerical results.
5.1. The benchmark problem: ï¬‚ow past a squared cylinder
As a validation test, we numerically simulate the ï¬‚ow past a squared cylinder at Reynolds number Re Â¼ 22; 000. This problem

3.2 2
3

2.8

1

2.6 0
2.4

2.2

âˆ’1

2 âˆ’2
1.8

2

4

6

8

10

2

4

6

8

10

3.2 2
3

2.8

1

2.6 0
2.4

2.2

âˆ’1

2 âˆ’2
1.8

2

4

6

8

10

2

4

6

8

10

3.2 2
3

2.8

1

2.6 0
2.4

2.2

âˆ’1

2 âˆ’2
1.8

2

4

6

8

10

2

4

6

8

10

Fig. 6. Results obtained by P2â€“P2 Finite Element and the BDF2 scheme; CD (left) and CL (right) vs. time t [s] for Dt Â¼ 0:005 s (top), 0.0025 s (mid), and 0.00125 s (bottom).

176

D. Forti, L. DedÃ¨ / Computers & Fluids 117 (2015) 168â€“182

Table 2 Results obtained by the semi-implicit BDF VMS-LES method by considering different time step s Dt and orders for the spatial and time discretizations.

FE discretization P1â€“P1

Time step
Dt Â¼ 0:01 s Dt Â¼ 0:005 s Dt Â¼ 0:0025 s Dt Â¼ 0:00125 s
Dt Â¼ 0:01 s Dt Â¼ 0:005 s Dt Â¼ 0:0025 s Dt Â¼ 0:00125 s

BDF order
1 1 1 1
2 2 2 2

CD
2.51 2.49 2.35 2.24
2.33 2.27 2.16 2.05

rmsÃ°C D Ã
0.250 0.226 0.112 0.0785
0.204 0.0896 0.0622 0.0420

rmsÃ°C L Ã
1.59 1.49 1.18 0.895
1.11 0.897 0.658 0.576

P2â€“P2

Dt Â¼ 0:005 s

2

Dt Â¼ 0:0025 s

2

Dt Â¼ 0:00125 s

2

1.98 2.24 2.71

0.102 0.121 0.153

0.580 0.986 1.49

Strouhal
0.127 0.133 0.138 0.142
0.142 0.144 0.146 0.146
0.142 0.141 0.129

Table 3 Results obtained by different numerical simulations based on LES models (results between brackets indicate a range of values).

LES method
Finite volumes VMS (Koobus et al. [25]) Smagorinsky (Rodi et al. [45]) Dynamic LES (Sohankar et al. [50])

CD
2.10 [1.66â€“2.77] [2.00â€“2.32]

rms(C D )
0.18 [0.1â€“0.27] [0.16â€“0.20]

rms(C L )
1.08 [0.38â€“1.79] [1.23â€“1.54]

Strouhal
0.136 [0.07â€“0.15] [0.127â€“0.135]

has been already investigated both experimentally [5,36] and

numerically by using Smagorinsky and dynamic LES models

[45,50], as well as with a VMS formulation for the compressible

Euler equations approximated by the Finite Volumes method

[25] (see also [26]).

The geometrical setting considered for this benchmark problem

is schematically illustrated in Fig. 1, for which D Â¼ 1 m is the side

length of the squared cylinder, Lin Â¼ 4:5 D and Lout Â¼ 15:5 D are the distances between the cylinder and the inï¬‚ow and outï¬‚ow surface

boundaries, respectively, Ls Â¼ 4 D is the width of the domain and H Â¼ 6:5 D is the distance between the cylinder and the bottom

and top walls.

Regarding the boundary conditions, at the surfaces on the top

and bottom of the domain we set a null normal component of

the velocity vector u Ã n^ Â¼ 0; similarly, at the lateral boundaries

we set the normal velocity component u Ã n^ Â¼ 0. At the inï¬‚ow of

the domain Cin, we prescribe a velocity proï¬le uinÃ°tÃ that is uniform along the inï¬‚ow section and it is dependent only on the time

independent variable as:

(

 

uinÃ°tÃ Â¼

p V 1
2

1 Ã€ cos

t Tr

V1

if 0 6 t < Tr; if t P Tr;

where, in the numerical tests, we have consider Tr Â¼ 0:3 s and the reference inï¬‚ow velocity V1 Â¼ 22 m/s At the outï¬‚ow boundary Cout, we consider the following natural boundary condition [3]:

Ã€pn^ Ã¾ 2lÃ°ru Ã¾ Ã°ruÃT Ã Ã n^ Ã€ qÃ°fu Ã n^gÃ€Ãu Â¼ 0 on Cout;

Ã°35Ã

where n^ is the outward directed unit vector normal to Cout and

fu Ã n^gÃ€ denotes the negative part of u Ã n^:

fu

Ã

n^ gÃ€

Â¼

&

u 0

Ã

n^

if u Ã n^ < 0; if u Ã n^ P 0:

The above boundary condition is introduced to weakly penalize the reverse ï¬‚ow induced by the vortexes at Cout, which may render unstable the discrete formulation of the problem. Indeed, we observe that only if u Ã n^ < 0 on Cout, the last term in the left hand side of Eq. (35) is active; if u Ã n^ P 0 Cout, the outï¬‚ow boundary condition considered coincides with the well known stress-free condition. On the squared cylinder surface we impose a no slip boundary

condition (u Â¼ 0). We consider the ï¬‚uid to have density

q Â¼ 1000 kg=m3 and a dynamic viscosity l Â¼ 1 Pa s. In this way

the

Reynolds

number

is

Re

Â¼

qV 1 D l

Â¼

22;

000.

We discretize the computational domain X by a mesh com-

prised of 330; 764 vertices and 1; 853; 500 tetrahedral elements.

In Fig. 2, two images of the computational mesh T h are presented: on the left we show a vertical cut plane of the mesh and on the

right an horizontal cut through the squared cylinder. Along the side

length of the cylinder we considered about 20 mesh elements, cor-

responding to a length hbl Â¼ 0:05 m. We remark that the mesh size is not uniform in X and the ratio between the largest and the

smallest local mesh sizes is about 10â€“15.

We solve the benchmark problem using the semi-implicit

VMS-LES method based on the BDF formulas. We analyze the per-

formances of the method with respect to the use of ï¬rst (r Â¼ 1)

and second (r Â¼ 2) order BDF schemes for different time steps

(Dt Â¼ 0:005s; Dt Â¼ 0:0025 s, and Dt Â¼ 0:00125 s) and different

degrees of polynomials used for the Finite Element approximation,

speciï¬cally P1â€“P1 for r Â¼ 1 and P2â€“P2 for r Â¼ 2. The time interval

considered for the simulations is such that t 2 Ã°0; 14Ã s. In Table 1

we report the number of degrees of freedom associated to the

discretized problem for the numerical simulations performed.

In Fig. 3 we show a post-processing of the solution obtained by

using P2â€“P2 Finite Element and BDF2 scheme at time t Â¼ 10 s for

Dt Â¼ 0:0025 s, i.e. when the turbulent ï¬‚ow is fully developed.

Fig. 3(a) shows the coherent vortex structures characterizing

the wake (we identiï¬ed the structures by means of the k2 criterion [23]); in Fig. 3(b), we highlight the considerable

three-dimensional features of the turbulent ï¬‚ow occurring in the

wake region adjacent to the cylinder by means of a representation

of the streamlines colored by the vorticity ï¬eld. Fig. 3(c) illustrates

the pressure ï¬eld at a plane located at z Â¼ 0, as well as some signif-

icant isosurfaces; we showed only negative values of the pressure

ï¬eld in order to highlight the low pressure zones characterizing the

center of the vortexes in the wake region. In Fig. 3(d) we illustrate

the vorticity ï¬eld, both on the squared cylinder and on a cut plane

at z Â¼ 0, on which we also show, by means of a surface LIC, the

recirculation of the ï¬‚ow detaching from the cylinder.

In order to compare the results with those available in literature

obtained by other LES methods, we compute the drag and lift

D. Forti, L. DedÃ¨ / Computers & Fluids 117 (2015) 168â€“182

177

coefï¬cients

on

the

cylinder.

Let

us

introduce

v^ 1

Â¼

v1
kV 1

k,

that

is

a

unit vector directed as the incoming ï¬‚ow, and n^1, a unit vector

orthogonal to the direction v^1 of the incoming ï¬‚ow. The aerody-

namic drag and lift coefï¬cients for the cylinder are deï¬ned as:

I

1 CDÃ°u; pÃ Â¼ Ã€ q1jCBODYIj

Ã°rÃ°u; pÃn^Ã Ã v^1dC;
CBODY

1 CLÃ°u; pÃ Â¼ q1jCBODY j

Ã°rÃ°u; pÃn^Ã Ã n^1dC;
CBODY

Ã°36Ã Ã°37Ã

where

q1

Â¼

1 2

qV

2 1

is

the

dynamic

pressure,

and

jCBODY j

is

the

surface

area of the cylinder; in Eq. (36) the minus sign takes into account

that, by convention, the force is positive if acting on the ï¬‚uid. In

practice, we compute the aerodynamic drag and lift coefï¬cients

by means of the weak residual form ([6,14,27]) which ensures

higher accuracy than the direct use of Eqs. (36) and (37); with this

aim,

we

use

the

test

functions

v d1

2

fÂ½H1

d
Ã°XÃÂŠ

:

d1 jCBODY

Â¼

^1;

d1 j@ XnCBODY

Â¼ 0g

and

l1

2

fÂ½H1

d
Ã°XÃÂŠ

: l1jCBODY

Â¼ n^ 1; l1j@XnCBODY

Â¼ 0g

in

Eq. (28). In Fig. 4 we illustrate, for the different time steps consid-

ered, the evolution of the drag (left-hand side) and lift (right-hand

side) coefï¬cients when using a ï¬rst order scheme for both the spa-

tial and the time discretizations. In the same way, Figs. 5 and 6

show the evolution of the coefï¬cients using a second order BDF

scheme in time and a ï¬rst and second order approximations in

space, respectively. By a comparison of the numerical results

obtained using P1â€“P1 Finite Element (Figs. 4 and 5) we highlight

the effects of the time discretization. In detail, we can observe that

the amplitude of the oscillations of the lift and drag coefï¬cients are

substantially reduced when using a second order time discretiza-

tion with respect to BDF1. In the same way, the results of Figs. 5

and 6 (both obtained using the BDF2) allows to analyze the effects

of spatial discretization on the solution. More speciï¬cally, it is inter-

esting to analyze the interplay between the choice of the time

stepDt and the order of the spatial discretization. When using

P1â€“P1 Finite Element, the smaller Dt reduces both the amplitudes

of the oscillations of lift and drag coefï¬cients, as well as the mean

drag coefï¬cients CD. On the contrary, when a second order spatial discretization is adopted, smaller time steps lead to wider oscillations of the coefï¬cients and to higher mean values of the mean of the drag.
In order to compare the numerical results with those available

in literature, we evaluate the mean drag coefï¬cient CD, the root mean square of the lift and of the drag coefï¬cients, say rmsÃ°CDÃ and rmsÃ°CLÃ, and the Strouhal number obtained from a Fourier analysis of the lift coefï¬cient. In Table 2 we report the results predicted by the semi-implicit BDF VMS-LES method, whereas Table 3 contains the values obtained by other LES methods: in particular, we consider the results obtained with the VMS-Finite Volumes method of Koobus et al. [25], LES models of Rodi et al. [45], and Smagorinsky models of Sohankar et al. [50].
The choice of the time step Dt for the simulations has an important effect on the aerodynamic coefï¬cients independently from the order of the spatial and time discretizations. Indeed, from Table 2

we observe that the estimation of the mean drag coefï¬cient CD obtained with Dt Â¼ 0:005 s and Dt Â¼ 0:00125 s varies of approximately Ã†5% with respect to the value obtained with Dt Â¼ 0:0025 s. We notice that the use of P1â€“P1 Finite Element

yields a mean drag coefï¬cient CD that decreases as the time step gets smaller; on the contrary, by using P2â€“P2 Finite Element to

approximate the velocity and pressure ï¬elds, the value of CD increases as Dt decreases. The same consideration follows from the analysis of the root mean square values of both the lift and drag coefï¬cients. The results obtained using a ï¬rst order spatial-time discretizations (P1â€“P1 and BDF1) are in line with those available

100

Ekin(k)/Ekin,0 [âˆ’]

10âˆ’2

10âˆ’4

10âˆ’6

FEM P1 FEM P2

(k, kâˆ’5/3)

100

101

102

k [1/m]

Fig. 7. Relative energy spectra (energy vs. wave number) obtained using a ï¬rst and second order spatial discretization for BDF2 and Dt Â¼ 0:0025 s; logarithmic scales on both axes. The analysis is performed at time t Â¼ 10 s, when turbulence is fully developed, and has been carried out by using the software AnaFlame [54].

in literature: although the largest time step under consideration leads already to an accurate prediction of the Strouhal number, the smallest one, i.e. Dt Â¼ 0:00125 s, yields good estimation of all the coefï¬cients. We notice that the use of a ï¬rst order discretization in space and second in time (P1â€“P1 and BDF2) leads to an underestimation of the root mean square of the lift and drag coefï¬cients with respect to the results available in literature for
LES models, although the prediction of CD is sufï¬ciently accurate. Finally, by employing a second order spatial-time discretization (P2â€“P2 and BDF2) we notice that the rms(CL) and rms(CD) are in line with those obtained with other LES methods, although the smallest time step yields an overestimation of the mean drag
coefï¬cient CD.

5.2. Energy spectra

It is well known [40] that turbulence features a wide range of spatial and time scales. Fluctuation of the energy is produced at the level of large eddies (with low wave numbers). Vortex stretching mechanisms then generate smaller and smaller eddies and energy â€˜â€˜driftsâ€™â€™ down the spectrum to higher wave numbers. The slope of the energy spectrum vs. the wave number in this range remains constant, as Kolmogorov showed that this slope is Ã€5=3, based on dimensional arguments. We denote by EkinÃ°kÃ the energy spectrum, where k is the wave number (inversely proportional to the wavelength). In order to compute the energy spectrum, the numerical solution (velocity ï¬eld) obtained on the squared cylinder benchmark problem is evaluated on a lattice of 106 equally spaced points. The points are located within a cube in the wake, centered in 5 m downstream the cylinder. The side length of the cube is L Â¼ 3 m and 102 points are equally spaced along each direction; the results displayed in Fig. 7 show the energy spectra obtained. The slope of the energy spectra,1 for both the spatial discretizations considered, is in line with the one of the theoretical curve (k; kÃ€5=3).

5.3. Parallel performances of the solver

In Fig. 8 we report a strong scalability study of the solver performed using the P2â€“P2 and BDF2 discretizations of the benchmark problem for Dt Â¼ 0:0025 s. We recall that in this settings

1 The sharp drop of Ekin beyond k â€™ 401=m is due to the fact that the local size hK of the computational mesh is larger than the distance of the points used for the sampling of the velocity ï¬eld, for which the associated energy is negligible.

178

D. Forti, L. DedÃ¨ / Computers & Fluids 117 (2015) 168â€“182

the total number of degrees of freedom is equal to 9; 209; 040. In our investigation, we consider a varying number of CPUs ranging from 64 to 4096 and we monitor the time to build the preconditioner (Fig. 8(a)), to solve the linear system by the preconditioned GMRES method (Fig. 8(b)), and to perform a time step, i.e. the sum of the time spent to update the convective and the VMS-LES terms in the assembly phase, to build the preconditioner, and to solve the linear system (Fig. 8(c)). Furthermore, in Fig. 8(d) we show the mean number of GMRES iterations employed to solve the linear system with the prescribed tolerance. All the computations are carried out using Piz Dora, a Cray XC40 supercomputer installed at the Swiss National Supercomputing Center (CSCS) whose main technical speciï¬cations are reported in Table 4.
The results reported in Fig. 8 show the excellent scalability properties of the solver up to 2048 CPUs: in fact, all the indicators scale almost perfectly and the number of iterations of the GMRES solver remains constant. More speciï¬cally, only when using 2048 CPUs we start to observe an initial deterioration in the scalability of the time to build the preconditioner and to solve the linear system. Nevertheless, in terms of time to perform a time step, remarkably only with 4096 CPUs we start to notice a slight deterioration of the performance. This is due to the fact that, within the overall count of the operations required to perform a time step, the assembly phase necessary to update the convective and VMS-LES stabilization terms is the most expensive, taking around the 85% of the total time spent for a time step, although perfectly scalable. This follows from the fact that the VMS-LES formulation (31) requires the assembly of several terms, in particular those associated to the second order Laplace operator; as consequence, this

results in an increased computational cost with respect to formulations of the Navierâ€“Stokes equations without the LES modeling terms.
Regarding the GMRES solver, in order to asses the suitability of the tolerance 10Ã€6 for the stopping criterion based on the relative residual, we solve the problem also with the tolerance 10Ã€4; with this aim, we use the ï¬rst order discretization in space and second in time (P1â€“P1 and BDF2) for Dt Â¼ 0:0025 s. In this case, the computational cost associated to the GMRES solver is greatly reduced with respect to the tolerance 10Ã€6, as the number of iterations is about halved. At the same time, the numerical results are in line with those obtained previously, with a discrepancy of the mean
drag coefï¬cient CD of about 1%. Conversely, reducing the tolerance under 10Ã€6 would lead to an unnecessary increase of the computational cost associated to the GMRES solver without any noticeable improvement of the numerical results.

Table 4 Piz Dora Cray XC40 technical data.
Number of compute nodes Processor
Memory
Memory bandwidth Network

1256 Dual-socket Intel Xeon processor E5-2690v3, 2.5 GHz 64 GB per node in 1192 nodes 128 GB per node in 64 nodes Up to 137 GB/s per node Dragonï¬‚y interconnect

102

102

101 101
100

10âˆ’1

100

101

102

103

104

101

102

103

104

103

25

24

23 102
22

21

101

20

101

102

103

104

101

102

103

104

Fig. 8. Scalability analysis of the solver. Simulations performed using P2â€”P2 Finite Element, BDF2 and Dt Â¼ 0:0025 s.

D. Forti, L. DedÃ¨ / Computers & Fluids 117 (2015) 168â€“182

179

5.4. Stabilization parameters

We address, for the benchmark problem at hand, the depen-

dency

of

the

stabilization

parameters

snÃ¾1;r M

and

snÃ¾1;r C

of

Eqs.

(32)

and (33) on the choice of the time step Dt. With this aim, we

visualize

the

spatial

distributions

of

snÃ¾1;r M

and

snÃ¾1;r C

on

the

mid

plane of the computational domain starting from the velocity ï¬eld

computed at the time t Â¼ 10:0 s by means of P1â€“P1 Finite Element

and the BDF2 scheme for Dt Â¼ 0:0025 s; the corresponding com-

puted velocity and pressure ï¬elds are reported in Fig. 9, while

Fig. 9. Reference velocity (a) and pressure (b) ï¬elds computed at time t Â¼ 10:0 s using P1â€“P1 Finite Element and the BDF2 scheme with Dt Â¼ 0:0025 s; the velocity ï¬eld is

used

to

evaluate

the

stabilization

parameters

snÃ¾1;r M

and

snÃ¾1;r C

.

Fig. 10.

Spatial distribution (on

the mid

plane of

X)

of

the

stabilization

parameter

snÃ¾1;r M

computed from

the reference

velocity

ï¬eld of

Fig. 9(a) using P1â€“P1 Finite Element

and the BDF2 scheme for different time steps Dt Â¼ 0:01; 0:005; 0:0025, and 0.00125 s.

180

D. Forti, L. DedÃ¨ / Computers & Fluids 117 (2015) 168â€“182

Fig.

11.

Spatial

distribution

(on

the

mid

plane

of

X)

of

the

stabilization

parameter

snÃ¾1;r C

computed

from

the

reference

velocity

ï¬eld

of

Fig.

9(a)

and

the

parameters

snÃ¾1;r M

of

Fig. 10 using P1â€“P1 Finite Element and the BDF2 scheme for different time steps Dt Â¼ 0:01; 0:005; 0:0025, and 0.00125 s.

the

values

of

snÃ¾1;r M

and

snÃ¾1;r C

for

the

time

steps

Dt

Â¼ 0:01; 0:005;

0:0025, and 0:00125 s are reported in Figs. 10 and 11. From

Fig. 10(a) we observe that the largest time step under considera-

tion,

Dt

Â¼ 0:01 s,

leads

to

a

distribution

of

snÃ¾1;r M

that

reï¬‚ects

the

value of the local mesh size hK and velocity ï¬eld uhnÃ¾1;r. However,

as the time step Dt diminishes, the magnitude of the stabilization

parameter

snÃ¾1;r M

diminishes

and

its

spatial

distribution

only

mildly

depends on the local mesh size and the velocity magnitude. In fact,

from

the

deï¬nition

of

snÃ¾1;r M

in

Eq.

(32),

we

remark

that

the

use

of

small time steps tends to annihilate the dependence on hK and

uhnÃ¾1;r ,

as

it

is

possible

to

observe

in

Fig.

10(d)

where

snÃ¾1;r M

mostly

behaves

as

Dt q

for

Dt

!

0.

We

report

in

Fig.

11

the

behavior

of

the

stabilization

parameter

snÃ¾1;r C

computed

as

in

Eq.

(33).

We

notice

that,

since

mild

dependencies

of

snÃ¾1;r M

on

hK

and

uhnÃ¾1;r

are

observed for the values of the Dt under considerations, the param-

eter

snÃ¾1;r C

mostly

depends

on

the

local

mesh

size

hk;

indeed,

we

have considered a variable mesh size as highlighted in Fig. 2. As

consequence, the ratio between the largest and smallest local

values

of

snÃ¾1;r C

in

X

is

approximatively

150

regardless

of

the

time

step Dt under consideration.

While it is well known that the stabilization parameters chosen

as in Eqs. (32) and (33) degenerate as the time step decreases (see

e.g.

[13,28]),

i.e

snÃ¾1;r M

$

Dt

!

0

and

snÃ¾1;r C

$

1 Dt

!

1

for

Dt

!

0,

and

hence the stabilization and turbulence LES modeling may be

ineffective for relatively small values of Dt ([13]), we stress the fact

that we did not encounter any stabilization issue in our numerical

simulations for the time steps under consideration. However, our

experience based on numerical tests indicates that for very â€˜â€˜smallâ€™â€™

values

of

Dt,

i.e.

when

the

term

related

to

Dt

in

snÃ¾1;r M

is

not

cor-

rectly balanced with respect to the other ones, the degeneration

of

the

parameters

snÃ¾1;r M

and

snÃ¾1;r C

is

reï¬‚ected

at

the

numerical

level by convergence issues of the linear solver and eventually by

the inability of assembling a suitable preconditioner.

An alternative formulation of the stabilization parameters of

Eqs. (32) and (33) can be used by completely neglecting the effect

of time dependency of the ï¬ne scale velocity u0 in the ï¬ne scale

momentum

equation,

where

one

assumes

that

@u0 @t

â€™

0.

This

leads

to

consider

stabilization

parameters

se

nÃ¾1;r
M

and

se

nÃ¾1;r
C

in

Eqs.

(14)

and (15) independent of the time step Dt, which read:

senMÃ¾1;r :Â¼

q2
h2K

uhnÃ¾1;r2

Ã¾

l2
h4K

!Ã€1=2

Cr

;

s s enCÃ¾1;r

Â¼

h2K enMÃ¾1;r

:

However, we remark that we were unable to successfully perform numerical simulations by using the previous deï¬nitions of the stabilization parameters, even for different choices of Dt; speciï¬cally, we experienced convergence issues using the GMRES solver with

D. Forti, L. DedÃ¨ / Computers & Fluids 117 (2015) 168â€“182

181

Fig. 12. Spatial distribution (on the mid plane of X) of the stabilization parameters senMÃ¾1;r and senCÃ¾1;r computed from the reference velocity ï¬eld of Fig. 9(a) using P1â€“P1 Finite
Element.

the ML preconditioner, which prevented the simulations to signiï¬-

cantly advance beyond the time Tv Â¼ 0:3 s. Our interpretation of this outcome is that a suitable multigrid preconditioner can not

be

â€˜â€˜easilyâ€™â€™

assembled

when

the

stabilization

parameters

se

nÃ¾1;r
M

and senCÃ¾1;r are signiï¬cantly varying in the computational domain

X. Following the procedure described before, we plot in Fig. 12

the

spatial

distributions

of

the

parameters

se

nÃ¾1;r
M

and

se

nÃ¾1;r
C

;

in

par-

ticular, we highlight that senMÃ¾1;r varies of approximately two orders

of magnitude in X, while the ratio between the largest and smallest

local values of senCÃ¾1;r is approximatively 3000, a value much larger

than

the

one

obtained

with

snÃ¾1;r C

,

which

was

about

150.

We

notice

that senMÃ¾1;r is relatively â€˜â€˜largeâ€™â€™ where the velocity magnitude is

nearly zero, as it occurs in the boundary layers and some regions

in the vortexes wake. This, in combination with the â€˜â€˜smallâ€™â€™ mesh

size hK in the boundary layers and wake regions, renders the param-
eter senCÃ¾1;r relatively â€˜â€˜smallâ€™â€™ locally in X; conversely, this becomes
â€˜â€˜largeâ€™â€™ far from the cylinder, where the mesh is locally coarse and

the velocity magnitude nearly equal to V1. We ï¬nally remark that the choice of the stabilization parame-

ters may have a signiï¬cant impact on the numerical results, espe-

cially if, as in this work, we take into account only in an

approximate manner for the time dependencies of the ï¬ne scales

using

the

parameters

snÃ¾1;r M

and

snÃ¾1;r C

of

Eqs.

(32)

and

(33).

While this can be improved by using dynamic subscales models

[11â€“13], the latter require to solve systems of ordinary differential

equations to determine the ï¬ne scale solutions u0 and p0, which

may increase the accuracy of the results, but also the computa-

tional cost of the simulations. Since in this work we focus on the

efï¬ciency aspects of the numerical solver, we decided to consider

the stabilization parameters as in Eqs. (32) and (33), which never-

theless represent a common choice in literature [2,3,15,20,51].

6. Conclusions
In this work we proposed a semi-implicit time discretization of the Navierâ€“Stokes equations with Variational Multiscale-Large Eddy Simulation (VMS-LES) modeling of turbulence. We used Backward Differentiation Formulas (BDF) for the time discretization and the Finite Element method for the spatial approximation, considering the same space of Lagrange polynomials to represent the ï¬‚uid velocity and pressure ï¬elds. We â€˜â€˜linearizedâ€™â€™ the fully discrete nonlinear problem by extrapolation based on Newtonâ€“

Gregory backward polynomials, thus obtaining a semi-implicit scheme for turbulence LES modeling. In this way, we limit the computational costs of the simulation since only a linear system has to be assembled and solved at each time step. In order to cope with the computational complexity of the problem, we developed a parallel solver based on the GMRES method preconditioned by a multigrid (ML) preconditioner.
We validated the proposed numerical scheme by solving the benchmark problem of the ï¬‚ow past a squared cylinder at high Reynolds number. We investigated how the accuracy of the solution is inï¬‚uenced by the choice of the time step and of the orders of the spatial and time discretizations and, in this respect, we discussed the role of the stabilization parameters. Furthermore, we studied the performance of the solver implemented in a parallel setting, showing the good scalability properties up to thousands of CPUs. All the numerical experiments performed yielded results that were in line with those available in literature obtained by other LES models. This highlights that the proposed semi-implicit BDF time discretization scheme for the Navierâ€“Stokes equations with VMS-LES modeling is not only efï¬cient, but also robust and accurate for the simulation of turbulent ï¬‚ows.
Acknowledgements
The research of D. Forti was supported by the Swiss National Foundation (SNF), project No. 140184. The authors gratefully acknowledge the Swiss National Supercomputing Center (CSCS) for providing the CPU resources for the numerical simulations under project ID s475. Finally, the authors acknowledge Prof. R. Codina, Dr. S. Deparis, Dr. T. Lassila, and Prof. A. Quarteroni for the fruitful discussions, suggestions, and advice.
References
[1] Akkerman I, Bazilevs Y, Calo VM, Hughes TJR, Hulshoff S. The role of continuity in residual-based variational multiscale modeling of turbulence. Comput Mech 2008;41(3):371â€“8.
[2] Bazilevs Y, Calo VM, Cottrell JA, Hughes TJR, Reali A, Scovazzi G. Variational multiscale residual-based turbulence modeling for large eddy simulation of incompressible ï¬‚ows. Comput Meth Appl Mech Eng 2007;197(1â€“4):173â€“201.
[3] Bazilevs Y, Gohean JR, Hughes TJR, Moser RD, Zhang Y. Patient-speciï¬c isogeometric ï¬‚uid-structure interaction analysis of thoracic aortic blood ï¬‚ow due to implantation of the Jarvik 2000 left ventricular assist device. Comput Meth Appl Mech Eng 2009;198(45â€“46):3534â€“50.
[4] Bazilevs Y, Takizawa K, Tezduyar TE. Computational ï¬‚uidâ€“structure interaction: methods and applications. Chirchester, UK: Wiley & Sons; 2013.

182

D. Forti, L. DedÃ¨ / Computers & Fluids 117 (2015) 168â€“182

[5] Bearman P, Obasaju E. An experimental study of pressure ï¬‚uctuations on ï¬xed and oscillating square-section cylinders. J Fluid Mech 1981;119:297â€“321.
[6] Becker R, Rannacher R. An optimal control approach to a posteriori error estimation in ï¬nite element methods. Acta Numer 2001;10:1â€“102.
[7] Brenan KE, Campbell SLV, Petzold LR. Numerical solution of initial-value problems in differential-algebraic equations. New York: North-Holland Publishing Co.; 1989.
[8] Calo VM, Bazilevs Y, Hughes TJR, Moser R. Turbulence modeling for large eddy simulations. Comput Meth Appl Mech Eng 2010;199(13â€“16):779.
[9] Calvo M, Grigorieff RD. Time discretisation of parabolic problems with the variable 3-step BDF. BIT Numer Math 2002;42(4):689â€“701.
[10] Cellier FE, Kofmanl E. Continuous system simulation. New York: Springerâ€“ Verlag; 2006.
[11] Codina R. Stabilized ï¬nite element approximation of transient incompressible ï¬‚ows using orthogonal subscales. Comput Meth Appl Mech Eng 2002;191: 4295â€“321.
[12] Codina R, Principe J, Guasch O, Badia S. Time dependent subscales in the stabilized ï¬nite element approximation of incompressible ï¬‚ow problems. Comput Meth Appl Mech Eng 2007;196:2413â€“30.
[13] ColomÃ©s O, Badia S, Codina R, Principe J. Assessment of variational multiscale models for the large eddy simulation of turbulent incompressible ï¬‚ows. Comput Meth Appl Mech Eng 2015;285:32â€“63.
[14] DedÃ¨ L. Optimal ï¬‚ow control for Navierâ€“Stokes equations: drag minimization. Int J Numer Meth Fluids 2007;55:347â€“66.
[15] Gamnitzer P, Gravemeier V, Wall WA. Time-dependent subgrid scales in residual-based large eddy simulation of turbulent channel ï¬‚ow. Comput Meth Appl Mech Eng 2010;199:819â€“27.
[16] Gear CW. Simultaneous numerical solution of differential-algebraic equations. IEEE Trans Circ Theory 1971;18(1):89â€“95.
[17] Gee MW, Siefer CM, Hu JJ, Tuminaro RS. ML 5.0 smoothed aggregation userâ€™s guide. Sandia National Laboratories; 2006.
[18] Germano M, Piomelli U, Moin P, Cabot WH. A dynamic subgrid-scale eddy viscosity model. Phys Fluids A 1991;3(7):1760â€“5.
[19] Gervasio P, Saleri F, Veneziani A. Algebraic fractional-step schemes with spectral methods for the incompressible Navierâ€“Stokes equations. J Comput Phys 2006;214(1):347â€“65.
[20] Gravemeier V, Gee MW, Kronbichler M, Wall WA. An algebraic variational multiscale-multigrid method for large eddy simulation of turbulent ï¬‚ow. Comput Meth Appl Mech Eng 2010;199:853â€“64.
[21] Jansen KE, Whiting CH, Hulbert GM. A generalized-a method for integrating
the ï¬ltered Navierâ€“Stokes equations with a stabilized ï¬nite element method. Comput Meth Appl Mech Eng 1999;190:305â€“19. [22] Jansson N, Hoffman J, Jansson J. Framework for massively parallel adaptive ï¬nite element computational ï¬‚uid dynamics on tetrahedral meshes. SIAM J Sci Comput 2012;34:C24â€“41. [23] Jeong J, Hussain F. On the identiï¬cation of a vortex. J Fluid Mech 1995;285: 69â€“94. [24] Kim J, Moin P, Moser R. Turbulence statistics in fully developed channel ï¬‚ow at low Reynolds number. J Fluid Mech 1987;177:133â€“66. [25] Koobus B, Farhat C. A variational multiscale method for the large eddy simulation of compressible turbulent ï¬‚ows on unstructured meshesâ€” application to vortex shedding. Comput Meth Appl Mech Eng 2003;193(15â€“16): 1367â€“83. [26] Koobus B, Tran H, Farhat C. Computation of unsteady viscous ï¬‚ows around
moving bodies using the k- turbulence model on unstructured dynamic grids.
Comput Meth Appl Mech Eng 2000;190:1441â€“66. [27] Hoffman J. Computation of mean drag for bluff body problems using adaptive
DNS/LES. SIAM J Sci Comput 2006;27:184â€“207. [28] Hsu MC, Bazilevs Y, Calo VM, Tezduyar TE, Hughes TJR. Improving stability of
stabilized and multiscale formulations in ï¬‚ow simulations at small time steps. Comput Meth Appl Mech Eng 2010;199:828â€“40.

[29] Hughes TJR. Multiscale phenomena: Greens functions, the Dirichlet-toNeumann formulation, subgrid scale models, bubbles, and the origins of stabilized methods. Comput Meth Appl Mech Eng 1995;127:387â€“401.
[30] Hughes TJR, Calo VM, Scovazzi G. Variational and multiscale methods in turbulence. In: Gutkowski W, Kowalewski TA, editors. Mechanics of the 21st century. Amsterdam: Springer; 2005. p. 153â€“63.
[31] Hughes TJR, Mazzei L, Jansen KE. Large-eddy simulation and the variational multiscale method. Comput Vis Sci 2000;3:47â€“59.
[32] Hughes TJR, Mazzei L, Oberai AA, Wray AA. The multiscale formulation of large eddy simulation: Decay of homogeneous isotropic turbulence. Phys Fluids 2001;13(2):505â€“12.
[33] Hughes TJR, Oberai AA, Mazzei L. Large eddy simulation of turbulent channel ï¬‚ows by the variational multiscale method. Phys Fluids 2001;13(6): 1784â€“99.
[34] Hughes TJR, Scovazzi G, Franca LP. Multiscale and stabilized methods. In: Stein E, de Borst R, Hughes TJR, editors. Encyclopedia of computational mechanics. John Wiley & Sons; 2004.
[35] Lilly DK. A proposed modiï¬cation of the Germano subgridscale closure method. Phys Fluids A 1992;4(3):633â€“5.
[36] Lyn D, Einav S, Rodi W, Park J. A laser-doppler velocimeter study of ensembleaveraged characteristics of the turbulent near wake of a square cylinder. J Fluid Mech 1995;304:285â€“319.
[37] Masud A, Calderer R. A variational multiscale stabilized formulation for the incompressible Navierâ€“Stokes equations. Comput Mech 2009;44(2): 145â€“60.
[38] Moser RD, Kim J, Mansour NN. Direct numerical simulations of turbulent channel ï¬‚ow up to Res Â¼ 590. Phys Fluids 1999;11:943â€“5.
[39] Nicoud F, Ducros F. Subgrid-scale modelling based on the square of the velocity gradient tensor. Flow Turbul Combust 1999;62:183â€“200.
[40] Pope SB. Turbulent ï¬‚ows. Cambridge University Press; 2000. [41] Quarteroni A, Saleri F, Sacco R. Numerical mathematics. Berlin: Springer; 2007. [42] Quarteroni A, Valli A. Domain decomposition methods for partial differential
equations. New York: Oxford University Press; 1999. [43] Quarteroni A, Valli A. Numerical approximation of partial differential
equations. Berlin and He idelberg: Springer-Verlag; 1994. [44] Rao GS. Numerical analysis. New Delhi: New Age International Publishers;
2009. [45] Rodi W, Ferziger J, Breuer M, PourquiÃ© M. Status of large eddy simulations:
results of a workshop. J Fluids Eng 1997;119:248â€“62. [46] Ruge J, StÃ¼ben K. Algebraic multigrid (AMG). In: McCormick SF, editor.
Multigrid methods frontiers in applied mathematics, vol. 3. Philadelphia, PA: SIAM; 1987. p. 73â€“130. [47] Sagaut P. Large eddy simulation for incompressible ï¬‚ows. 3rd ed. Berlin: Springer-Verlag; 2006. [48] Shakib F, Hughes TJR, Johan Z. A new ï¬nite element formulation for computational ï¬‚uid dynamics: X. The compressible Euler and Navierâ€“Stokes equations. Comput Meth Appl Mech Eng 1991;89(1â€“3):141â€“219. [49] Smagorinsky JS. General circulation experiments with the primitive equations. Mon Weather Rev 1963;91:99â€“164. [50] Sohankar A, Davidson L, Norberg C. Large eddy simulation of ï¬‚ow past a square cylinder: comparison of different subgrid scale models. J Fluids Eng 2000;122:39â€“47. [51] Tezduyar TE, Sathe S. Stabilization parameters in SUPG and PSPG formulations. J Comput Appl Mech 2003;4(1):71â€“88. [52] Toselli A, Widlund O. Domain decomposition methods â€“ algorithms and theory. Berlin: Springer-Verlag; 2005. [53] Villa U. Scalable efï¬cient methods for incompressible ï¬‚uid-dynamics in engineering problems. PhD thesis, Emory University; 2012. [54] Zistl C, Hilbert R, Janiga G, ThÃ©venin D. Increasing the efï¬ciency of postprocessing for turbulent reacting ï¬‚ows. Comput Vis Sci 2009;12(8):383â€“95. [55] LifeV website: <www.lifev.org>.

